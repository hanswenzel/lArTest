#include "math.h"
#include <iostream>
#include "TGraph.h"
#include "TCanvas.h"
#include "TLegend.h"
#include "TMultiGraph.h"
#include "TAxis.h"
#include "TF1.h"
/*
        <matrix coldim="2" name="FASTCOMPONENT0x4b710b0" values="1.55e-06 0 2.0664e-06 0.007298 2.06985e-06 0.007011 2.07331e-06 0.007932 2.07679e-06 0.008065 2.08027e-06 0.007699 2.08377e-06 0.00662 2.08728e-06 0.007727 2.0908e-06 0.007464 2.09433e-06 0.007931 2.09787e-06 0.006825 2.10143e-06 0.007623 2.10499e-06 0.006487 2.10857e-06 0.007494 2.11217e-06 0.007604 2.11577e-06 0.00725 2.11939e-06 0.007187 2.12302e-06 0.008465 2.12666e-06 0.007539 2.13031e-06 0.007951 2.13398e-06 0.007393 2.13766e-06 0.008746 2.14135e-06 0.008358 2.14506e-06 0.008536 2.14877e-06 0.008132 2.1525e-06 0.009147 2.15625e-06 0.009598 2.16e-06 0.008566 2.16377e-06 0.00837 2.16756e-06 0.009756 2.17135e-06 0.007964 2.17516e-06 0.008557 2.17898e-06 0.009199 2.18282e-06 0.009928 2.18667e-06 0.008394 2.19053e-06 0.009174 2.19441e-06 0.009142 2.1983e-06 0.009985 2.20221e-06 0.009611 2.20612e-06 0.009985 2.21006e-06 0.011081 2.214e-06 0.010671 2.21796e-06 0.010177 2.22194e-06 0.012099 2.22593e-06 0.010819 2.22993e-06 0.011596 2.23395e-06 0.012298 2.23798e-06 0.012099 2.24203e-06 0.012604 2.24609e-06 0.013004 2.25017e-06 0.013502 2.25426e-06 0.012587 2.25836e-06 0.014589 2.26249e-06 0.015733 2.26662e-06 0.015105 2.27077e-06 0.014145 2.27494e-06 0.015762 2.27912e-06 0.015455 2.28332e-06 0.015944 2.28753e-06 0.015391 2.29176e-06 0.016797 2.296e-06 0.018667 2.30026e-06 0.018206 2.30454e-06 0.018382 2.30883e-06 0.020014 2.31314e-06 0.01994 2.31746e-06 0.021778 2.3218e-06 0.021521 2.32616e-06 0.023801 2.33053e-06 0.024522 2.33492e-06 0.024905 2.33932e-06 0.025821 2.34375e-06 0.028128 2.34819e-06 0.026988 2.35264e-06 0.029616 2.35711e-06 0.02854 2.3616e-06 0.029964 2.36611e-06 0.031531 2.37063e-06 0.034344 2.37518e-06 0.033769 2.37974e-06 0.036688 2.38431e-06 0.037003 2.38891e-06 0.038282 2.39352e-06 0.039943 2.39815e-06 0.042146 2.40279e-06 0.043553 2.40746e-06 0.044054 2.41214e-06 0.046702 2.41685e-06 0.045442 2.42157e-06 0.049577 2.42631e-06 0.053079 2.43106e-06 0.050783 2.43584e-06 0.056636 2.44063e-06 0.056936 2.44545e-06 0.058559 2.45028e-06 0.06142 2.45513e-06 0.064514 2.46e-06 0.065756 2.46489e-06 0.068394 2.4698e-06 0.073655 2.47473e-06 0.074814 2.47968e-06 0.080707 2.48465e-06 0.083768 2.48964e-06 0.087875 2.49465e-06 0.089284 2.49968e-06 0.095072 2.50473e-06 0.099422 2.5098e-06 0.107914 2.51489e-06 0.112227 2.52e-06 0.118243 2.52514e-06 0.122406 2.53029e-06 0.125939 2.53546e-06 0.131992 2.54066e-06 0.136012 2.54588e-06 0.140968 2.55112e-06 0.147579 2.55638e-06 0.15602 2.56166e-06 0.158363 2.56696e-06 0.167771 2.57229e-06 0.168055 2.57763e-06 0.175895 2.583e-06 0.179084 2.5884e-06 0.185346 2.59381e-06 0.193068 2.59925e-06 0.198061 2.60471e-06 0.202359 2.61019e-06 0.206894 2.6157e-06 0.212571 2.62123e-06 0.218799 2.62678e-06 0.223242 2.63236e-06 0.229322 2.63796e-06 0.239725 2.64359e-06 0.250068 2.64924e-06 0.257243 2.65491e-06 0.264742 2.66061e-06 0.281645 2.66633e-06 0.29474 2.67207e-06 0.309784 2.67784e-06 0.32245 2.68364e-06 0.343039 2.68946e-06 0.363025 2.69531e-06 0.37534 2.70118e-06 0.400378 2.70708e-06 0.421838 2.713e-06 0.435316 2.71895e-06 0.452269 2.72493e-06 0.475444 2.73093e-06 0.489341 2.73696e-06 0.50568 2.74301e-06 0.52478 2.7491e-06 0.530979 2.7552e-06 0.542752 2.76134e-06 0.552351 2.7675e-06 0.562429 2.7737e-06 0.567725 2.77991e-06 0.572789 2.78616e-06 0.57806 2.79244e-06 0.588238 2.79874e-06 0.587622 2.80507e-06 0.584193 2.81143e-06 0.593162 2.81782e-06 0.601844 2.82424e-06 0.613819 2.83069e-06 0.628391 2.83717e-06 0.642112 2.84367e-06 0.656654 2.85021e-06 0.673388 2.85678e-06 0.704065 2.86338e-06 0.72785 2.87e-06 0.764664 2.87666e-06 0.791312 2.88335e-06 0.832467 2.89007e-06 0.87062 2.89683e-06 0.894459 2.90361e-06 0.929799 2.91043e-06 0.955303 2.91728e-06 0.977617 2.92416e-06 0.987266 2.93107e-06 0.999449 2.93801e-06 1 2.94499e-06 0.994073 2.952e-06 0.971962 2.95905e-06 0.958778 2.96613e-06 0.934527 2.97324e-06 0.902721 2.98039e-06 0.870857 2.98757e-06 0.838456 2.99479e-06 0.805928 3.00204e-06 0.785872 3.00933e-06 0.756622 3.01665e-06 0.733803 3.024e-06 0.724502 3.0314e-06 0.711707 3.03883e-06 0.722673 3.04629e-06 0.723408 3.0538e-06 0.739724 3.06134e-06 0.761128 3.06892e-06 0.78476 3.07653e-06 0.80347 3.08418e-06 0.818395 3.09188e-06 0.834321 3.09961e-06 0.828638 3.10737e-06 0.812963 3.11518e-06 0.788427 3.12303e-06 0.76173 3.13091e-06 0.705279 3.13884e-06 0.642877 3.14681e-06 0.582818 3.15481e-06 0.508845 3.16286e-06 0.435086 3.17095e-06 0.372081 3.17908e-06 0.304945 3.18725e-06 0.248959 3.19547e-06 0.200416 3.20373e-06 0.156939 3.21203e-06 0.128059 3.22037e-06 0.10221 3.22876e-06 0.082023 3.23719e-06 0.062593 3.24566e-06 0.051869 3.25418e-06 0.042981 3.26274e-06 0.035078 3.27135e-06 0.02894 3.28001e-06 0.024279 3.28871e-06 0.020112 3.29745e-06 0.016616 3.30625e-06 0.016298 3.31509e-06 0.014177 3.32397e-06 0.012852 3.33291e-06 0.012006 3.34189e-06 0.011478 3.35092e-06 0.009994 3.36001e-06 0.00932 3.36914e-06 0.008654 3.37832e-06 0.008841 3.38755e-06 0.008425 3.39683e-06 0.008513 3.40616e-06 0.008608 3.41554e-06 0.007599 3.42498e-06 0.008116 3.43446e-06 0.007355 3.44401e-06 0.006986 3.4536e-06 0.006304 3.46325e-06 0.0057 3.47295e-06 0.005496 3.4827e-06 0.004889 3.4925e-06 0.004423 3.50238e-06 0.003786 3.5123e-06 0.003303 3.52228e-06 0.003402 3.53231e-06 0.003424 3.54241e-06 0.002978 3.55256e-06 0.002702 3.56276e-06 0.002367 3.57303e-06 0.002698 3.58336e-06 0.002239 3.59375e-06 0.002125 3.60419e-06 0.002578 3.6147e-06 0.002259 3.62527e-06 0.002102 3.63591e-06 0.00205 3.64659e-06 0.002311 3.65735e-06 0.001994 3.66817e-06 0.001809 3.67906e-06 0.00169 3.69001e-06 0.001965 3.70102e-06 0.001909 3.7121e-06 0.002218 3.72325e-06 0.001887 3.73446e-06 0.001981 3.74575e-06 0.002153 3.7571e-06 0.002269 6.2e-06 0 1.033e-05 0 1.55e-05 0"/>
        <matrix coldim="2" name="SLOWCOMPONENT0x4b72290" values="1.55e-06 0 2.0664e-06 0.007298 2.06985e-06 0.007011 2.07331e-06 0.007932 2.07679e-06 0.008065 2.08027e-06 0.007699 2.08377e-06 0.00662 2.08728e-06 0.007727 2.0908e-06 0.007464 2.09433e-06 0.007931 2.09787e-06 0.006825 2.10143e-06 0.007623 2.10499e-06 0.006487 2.10857e-06 0.007494 2.11217e-06 0.007604 2.11577e-06 0.00725 2.11939e-06 0.007187 2.12302e-06 0.008465 2.12666e-06 0.007539 2.13031e-06 0.007951 2.13398e-06 0.007393 2.13766e-06 0.008746 2.14135e-06 0.008358 2.14506e-06 0.008536 2.14877e-06 0.008132 2.1525e-06 0.009147 2.15625e-06 0.009598 2.16e-06 0.008566 2.16377e-06 0.00837 2.16756e-06 0.009756 2.17135e-06 0.007964 2.17516e-06 0.008557 2.17898e-06 0.009199 2.18282e-06 0.009928 2.18667e-06 0.008394 2.19053e-06 0.009174 2.19441e-06 0.009142 2.1983e-06 0.009985 2.20221e-06 0.009611 2.20612e-06 0.009985 2.21006e-06 0.011081 2.214e-06 0.010671 2.21796e-06 0.010177 2.22194e-06 0.012099 2.22593e-06 0.010819 2.22993e-06 0.011596 2.23395e-06 0.012298 2.23798e-06 0.012099 2.24203e-06 0.012604 2.24609e-06 0.013004 2.25017e-06 0.013502 2.25426e-06 0.012587 2.25836e-06 0.014589 2.26249e-06 0.015733 2.26662e-06 0.015105 2.27077e-06 0.014145 2.27494e-06 0.015762 2.27912e-06 0.015455 2.28332e-06 0.015944 2.28753e-06 0.015391 2.29176e-06 0.016797 2.296e-06 0.018667 2.30026e-06 0.018206 2.30454e-06 0.018382 2.30883e-06 0.020014 2.31314e-06 0.01994 2.31746e-06 0.021778 2.3218e-06 0.021521 2.32616e-06 0.023801 2.33053e-06 0.024522 2.33492e-06 0.024905 2.33932e-06 0.025821 2.34375e-06 0.028128 2.34819e-06 0.026988 2.35264e-06 0.029616 2.35711e-06 0.02854 2.3616e-06 0.029964 2.36611e-06 0.031531 2.37063e-06 0.034344 2.37518e-06 0.033769 2.37974e-06 0.036688 2.38431e-06 0.037003 2.38891e-06 0.038282 2.39352e-06 0.039943 2.39815e-06 0.042146 2.40279e-06 0.043553 2.40746e-06 0.044054 2.41214e-06 0.046702 2.41685e-06 0.045442 2.42157e-06 0.049577 2.42631e-06 0.053079 2.43106e-06 0.050783 2.43584e-06 0.056636 2.44063e-06 0.056936 2.44545e-06 0.058559 2.45028e-06 0.06142 2.45513e-06 0.064514 2.46e-06 0.065756 2.46489e-06 0.068394 2.4698e-06 0.073655 2.47473e-06 0.074814 2.47968e-06 0.080707 2.48465e-06 0.083768 2.48964e-06 0.087875 2.49465e-06 0.089284 2.49968e-06 0.095072 2.50473e-06 0.099422 2.5098e-06 0.107914 2.51489e-06 0.112227 2.52e-06 0.118243 2.52514e-06 0.122406 2.53029e-06 0.125939 2.53546e-06 0.131992 2.54066e-06 0.136012 2.54588e-06 0.140968 2.55112e-06 0.147579 2.55638e-06 0.15602 2.56166e-06 0.158363 2.56696e-06 0.167771 2.57229e-06 0.168055 2.57763e-06 0.175895 2.583e-06 0.179084 2.5884e-06 0.185346 2.59381e-06 0.193068 2.59925e-06 0.198061 2.60471e-06 0.202359 2.61019e-06 0.206894 2.6157e-06 0.212571 2.62123e-06 0.218799 2.62678e-06 0.223242 2.63236e-06 0.229322 2.63796e-06 0.239725 2.64359e-06 0.250068 2.64924e-06 0.257243 2.65491e-06 0.264742 2.66061e-06 0.281645 2.66633e-06 0.29474 2.67207e-06 0.309784 2.67784e-06 0.32245 2.68364e-06 0.343039 2.68946e-06 0.363025 2.69531e-06 0.37534 2.70118e-06 0.400378 2.70708e-06 0.421838 2.713e-06 0.435316 2.71895e-06 0.452269 2.72493e-06 0.475444 2.73093e-06 0.489341 2.73696e-06 0.50568 2.74301e-06 0.52478 2.7491e-06 0.530979 2.7552e-06 0.542752 2.76134e-06 0.552351 2.7675e-06 0.562429 2.7737e-06 0.567725 2.77991e-06 0.572789 2.78616e-06 0.57806 2.79244e-06 0.588238 2.79874e-06 0.587622 2.80507e-06 0.584193 2.81143e-06 0.593162 2.81782e-06 0.601844 2.82424e-06 0.613819 2.83069e-06 0.628391 2.83717e-06 0.642112 2.84367e-06 0.656654 2.85021e-06 0.673388 2.85678e-06 0.704065 2.86338e-06 0.72785 2.87e-06 0.764664 2.87666e-06 0.791312 2.88335e-06 0.832467 2.89007e-06 0.87062 2.89683e-06 0.894459 2.90361e-06 0.929799 2.91043e-06 0.955303 2.91728e-06 0.977617 2.92416e-06 0.987266 2.93107e-06 0.999449 2.93801e-06 1 2.94499e-06 0.994073 2.952e-06 0.971962 2.95905e-06 0.958778 2.96613e-06 0.934527 2.97324e-06 0.902721 2.98039e-06 0.870857 2.98757e-06 0.838456 2.99479e-06 0.805928 3.00204e-06 0.785872 3.00933e-06 0.756622 3.01665e-06 0.733803 3.024e-06 0.724502 3.0314e-06 0.711707 3.03883e-06 0.722673 3.04629e-06 0.723408 3.0538e-06 0.739724 3.06134e-06 0.761128 3.06892e-06 0.78476 3.07653e-06 0.80347 3.08418e-06 0.818395 3.09188e-06 0.834321 3.09961e-06 0.828638 3.10737e-06 0.812963 3.11518e-06 0.788427 3.12303e-06 0.76173 3.13091e-06 0.705279 3.13884e-06 0.642877 3.14681e-06 0.582818 3.15481e-06 0.508845 3.16286e-06 0.435086 3.17095e-06 0.372081 3.17908e-06 0.304945 3.18725e-06 0.248959 3.19547e-06 0.200416 3.20373e-06 0.156939 3.21203e-06 0.128059 3.22037e-06 0.10221 3.22876e-06 0.082023 3.23719e-06 0.062593 3.24566e-06 0.051869 3.25418e-06 0.042981 3.26274e-06 0.035078 3.27135e-06 0.02894 3.28001e-06 0.024279 3.28871e-06 0.020112 3.29745e-06 0.016616 3.30625e-06 0.016298 3.31509e-06 0.014177 3.32397e-06 0.012852 3.33291e-06 0.012006 3.34189e-06 0.011478 3.35092e-06 0.009994 3.36001e-06 0.00932 3.36914e-06 0.008654 3.37832e-06 0.008841 3.38755e-06 0.008425 3.39683e-06 0.008513 3.40616e-06 0.008608 3.41554e-06 0.007599 3.42498e-06 0.008116 3.43446e-06 0.007355 3.44401e-06 0.006986 3.4536e-06 0.006304 3.46325e-06 0.0057 3.47295e-06 0.005496 3.4827e-06 0.004889 3.4925e-06 0.004423 3.50238e-06 0.003786 3.5123e-06 0.003303 3.52228e-06 0.003402 3.53231e-06 0.003424 3.54241e-06 0.002978 3.55256e-06 0.002702 3.56276e-06 0.002367 3.57303e-06 0.002698 3.58336e-06 0.002239 3.59375e-06 0.002125 3.60419e-06 0.002578 3.6147e-06 0.002259 3.62527e-06 0.002102 3.63591e-06 0.00205 3.64659e-06 0.002311 3.65735e-06 0.001994 3.66817e-06 0.001809 3.67906e-06 0.00169 3.69001e-06 0.001965 3.70102e-06 0.001909 3.7121e-06 0.002218 3.72325e-06 0.001887 3.73446e-06 0.001981 3.74575e-06 0.002153 3.7571e-06 0.002269 6.2e-06 0 1.033e-05 0 1.55e-05 0"/>
*/
const int nre=28;
const Double_t intensityre[nre]={
  0, 
  0, 
  0.0587, 
  0.1141, 
  0.1259, 
  0.1215, 
  0.116, 
  0.1372, 
  0.1344, 
  0.1409, 
  0.1417, 
  0.1712, 
  0.1936, 
  0.1969, 
  0.2203, 
  0.2354, 
  0.3004, 
  0.4165, 
  0.6353, 
  0.8022, 
  0.8004, 
  0.8006, 
  0.8, 
  0.45, 
  0.42, 
  0.4, 
  0.4, 
  0.4};

const Double_t energyre[nre]={1.55,
			      1.73987,
			      2.15315,
			      2.42867,
			      2.45963,
			      2.49129,
			      2.52368,
			      2.55682,
			      2.59075,
			      2.62547,
			      2.66104,
			      2.69747,
			      2.73481,
			      2.77308,
			      2.81231,
			      2.85255,
			      2.89384,
			      2.93621,
			      2.97972,
			      3.02439,
			      3.0703,
			      3.21588,
			      3.80628,
			      5.87347,
			      6.2,
			      7.75,
			      10.33,
			      15.5};
Double_t wlre[nre];


const double pi        = 3.14159265358979323846;
const double p3times16 = 16.*pi*pi*pi;
const double kA        = 6.02214129e23;       // Avogadro constant
const double kb        = 1.3806488e-16;       // boltzmanm constant in cm2 g s-2 K-1
const double c         = 299792458.;          // speed of light in m/sec
const double h         = 4.13566743E-15;      // Planck constant in eVsec
const int nr=15;
const Double_t energy[nr]= {2.17,
			    2.25, 
			    2.33, 
			    2.41, 
			    2.49,
			    2.57,          
			    2.65, 
			    2.73, 
			    2.81, 
			    2.89,
			    2.98, 
			    3.06, 
			    3.14, 
			    3.22, 
			    3.30};

const Double_t intensity[nr]={ 0.04,
			       0.12, 
			       0.27,
			       0.44, 
			       0.62,
			       0.80,          
			       0.91, 
			       0.92, 
			       0.85, 
			       0.70,
			       0.50, 
			       0.31, 
			       0.13, 
			       0.04, 
			       0.01};
double wl[nr];
double ehalf[nr];
double lambdatoe(double lambda)
{
  // input   photon wavelength in nm 
  // return  energy in eV
 double   E  = (h*c)/(lambda*1.e-9);
 return E;
}
double etolambda(double E)
{
  // input  photon energy in eV
  // return   wavelength in nm 
 double   lambda  = (h*c)/(E*1.e-9);
 return lambda;
}
void init()
{
for (int i=0;i<nre;i++)
  {
     wlre[i]= etolambda( energyre[i]);
  }
 for (int i=0;i<nr;i++)
  {
    // wl[i]= etolambda( energy[i]);
    ehalf[i]= energy[0]+0.2*(energy[i]-energy[0]);
    cout << ehalf[i]<<"*eV "<< intensity[i]<<endl;
    wl[i]= etolambda( ehalf[i]);
  }
}
void scint()
{
  init();
  TCanvas *canvas = new TCanvas("canvas", "spectrum", 200, 10, 1000, 800);
  TGraph *ve = new TGraph(nr,wl,intensity);
  ve-> SetTitle("scintillation wl spectrum");
  ve->SetLineColor(2);
  ve->SetMarkerColor(2);
  ve->SetMarkerStyle(22);
  ve->SetMarkerSize(2);
  ve->Draw();
  TCanvas *canvas2 = new TCanvas("canvas2", "spectrum", 200, 10, 1000, 800);
  TGraph *ve2 = new TGraph(nre,wlre,intensityre);
  ve2-> SetTitle("scintillation wlre spectrum");
  ve2->SetLineColor(2);
  ve2->SetMarkerColor(2);
  ve2->SetMarkerStyle(22);
  ve2->SetMarkerSize(2);
  ve2->Draw();
}
